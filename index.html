<html>
  <head>
    <title>Admissions new student ticker</title>
    <link rel="shortcut icon" type="image/x-icon" href="favicon.ico">
    <script type="text/javascript">
      const getStudents = () => {
        fetch ("https://admission.davidson.edu/manage/query/run?id=1615eb50-ebee-4e8c-a623-ac8915dcbe0f&h=e88865ed-4c1c-182f-72f6-3b87cd9c5ab3&cmd=service&output=json", {
            method: "GET",
            cache: "no-cache",
            headers: {
              "Content-Type": "application/json"
            },
            redirect: "follow",
            referrer: "no-referrer"
          })
          .then(rows => {
            return rows.json();
          })
          .then(students => {
            let studentsArray = students.row.map(student => student.value);
            let studentsString = `Welcome! ${studentsArray.join("; ")}`
            console.log(`Updated students array:\n${JSON.stringify(studentsArray)}`);
            return studentsString;
          })
          .then(welcomeString => {
            document.getElementById("marquee").innerText = welcomeString
            // document.getElementById("marquee").style = `min-width: ${welcomeString.length * 24}px;`
          })
          .catch(error => {
            console.error(`New students fetch Error =\n`, error);
          });
      }
    </script>
    <style type="text/css">
      body {
        background: #000000;
        color: #ffffff;
        overflow: hidden;
      }
      #marquee-container {
         height: 100%;
         overflow: hidden;
         position: absolute;
         display: flex;
         justify-content: center;
         align-items: center;
      }
      #marquee {
        font-family: "Lato", "sans-serif";
        font-size: 72px;
        position: absolute;
        white-space: nowrap;
        height: 100px;
        margin: 0;
        line-height: 100px;

        /* Starting position */
        transform:translateX(100%);
        /* Apply animation to this element */	
        animation: move-students 60s linear infinite;
      }
      /* Move it (define the animation) */
      @keyframes move-students {
        0% { 
          transform: translateX(100%); 		
        }
        100% { 
          transform: translateX(-100%); 
        }
      }
    </style>
  </head>
  <body onLoad="getStudents();">
    <div class="marquee-container">
      <h1 id="marquee"></h1>
    </div>
    <script type="text/javascript">
      setInterval(getStudents, 3600000);
    </script>
  </body>
</html>
